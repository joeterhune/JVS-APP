        select
            e.event_id as VRBEventID,
            ec.event_cases_id AS VRBEventCasesID,
            CASE et.event_type_desc
                WHEN 'Other' then e.event_name
                ELSE et.event_type_desc
            END as EventType,
            et.event_type_code as EventCode,
            e.division as Division,
            e.judge_name as JudgeName,
            e.ols_judge_id as OLSJudgeID,
            DATE_FORMAT(DATE(e.start_date), '%m/%d/%Y') as StartDate,
            DATE_FORMAT(DATE(e.start_date), '%Y-%m-%d') as ISODate,
            DATE_FORMAT(DATE(e.end_date) , '%m/%d/%Y') as EndDate,
            TIME_FORMAT(TIME(e.start_date), '%H:%i') as StartTime,
            TIME_FORMAT(TIME(e.end_date), '%H:%i') as EndTime,
            ec.case_num as CaseNumber,
            ec.case_style as CaseStyle,
            IFNULL(ec.event_notes,'&nbsp;') as EventNotes,
            CASE ec.is_sensitive
                WHEN 1 THEN 'Y'
                ELSE 'N'
            END as isSensitive,
            CASE ec.is_sealed
                WHEN 1 THEN 'Y'
                ELSE 'N'
            END as isSealed,
            CASE
                WHEN e.canceled = 1 THEN 'Y'
                WHEN ec.canceled = 1 THEN 'Y'
                ELSE 'N'
            END as isCanceled,
            i.import_source_name as ImportSourceName,
            IFNULL(ec.ols_conf_num,'N/A') as OLSConfNum,
            CASE
            	WHEN ec.lawfirm_name IS NOT NULL AND ec.lawfirm_name <> ''
            		THEN ec.lawfirm_name
            	WHEN lf.lawfirm_name IS NOT NULL
            		THEN lf.lawfirm_name
            	ELSE
            		'&nbsp;'
            END AS LawFirm,
            CASE
            	WHEN ec.attorney_name IS NOT NULL AND ec.attorney_name <> ''
            		THEN ec.attorney_name
            	WHEN u.bar_num IS NOT NULL
            		THEN CONCAT(IFNULL(u.first_name, ""), " ", IFNULL(u.middle_name, ""), " ", IFNULL(u.last_name, ""), " ", IFNULL(u.suffix, ""))
            	ELSE
            		'&nbsp;'
            END AS AttorneyName,
            CASE
            	WHEN ec.attorney_phone IS NOT NULL AND ec.attorney_phone <> ''
            		THEN ec.attorney_phone
            	WHEN u.bar_num IS NOT NULL
            		THEN CONCAT(IFNULL(u.bus_area_code, ""), IFNULL(u.bus_phone, ""))
            	ELSE
            		'&nbsp;'
            END AS AttorneyPhone,
             CASE
            	WHEN ec.attorney_email IS NOT NULL AND ec.attorney_email <> ''
            		THEN ec.attorney_email
            	WHEN u.bar_num IS NOT NULL AND ea.email_addr IS NOT NULL
            		THEN ea.email_addr
            	ELSE
            		'&nbsp;'
            END AS AttorneyEmail,
            CASE
            	WHEN ec.contact_name IS NOT NULL AND ec.contact_name <> ''
            		THEN ec.contact_name
            	WHEN u.first_name IS NOT NULL
            		THEN CONCAT(IFNULL(u.first_name, ""), " ", IFNULL(u.middle_name, ""), " ", IFNULL(u.last_name, ""), " ", IFNULL(u.suffix, ""))
            	ELSE
            		'&nbsp;'
            END AS ContactName,
           CASE
            	WHEN ec.contact_phone IS NOT NULL AND ec.contact_phone <> ''
            		THEN ec.contact_phone
            	WHEN u.bus_area_code IS NOT NULL
            		THEN CONCAT(IFNULL(u.bus_area_code, ""), IFNULL(u.bus_phone, ""))
            	ELSE
            		'&nbsp;'
            END AS ContactPhone,
            CASE
            	WHEN ec.contact_email IS NOT NULL AND ec.contact_email <> ''
            		THEN ec.contact_email
            	WHEN ea.email_addr IS NOT NULL
            		THEN ea.email_addr
            	ELSE
            		'&nbsp;'
            END AS ContactEmail,
            CASE
            	WHEN a.allotted_time IS NOT NULL
                	THEN a.allotted_time
                WHEN (time_allotted is null or time_allotted = 0)
                	THEN 'N/A'
                ELSE ec.time_allotted
            END as TimeAllotted,
            ec.motion,
            e.ex_parte_flag
        from
            events e left outer join event_cases ec on (e.event_id = ec.event_id)
                left outer join event_types et on (e.event_type_id = et.event_type_id)
                left outer join import_sources i on (e.import_source_id = i.import_source_id)
                left outer join ols_12.bulk_hearings_allotted_times a on (ec.ols_conf_num = a.conf_num and ( ec.case_num = a.case_num or CONCAT('50', ec.case_num) = a.case_num ))
                left outer join ols_12.law_firms lf on (ec.sched_lawfirm_id = lf.lawfirm_id)
                left outer join ols_12.users u on (ec.sched_user_id = u.user_id)
                left outer join ols_12.email_addresses ea on (u.login_id = ea.email_addr_id)
        where
            DATE(e.start_date) BETWEEN '2018-07-10' and '2018-07-10'
            and e.division = 'AA'
            and i.import_source_name <> 'Banner'
     AND ( is_scheduled = 1 OR ec.event_cases_id IS NOT NULL )  ORDER BY StartDate
